# s27.bench 回路構造図

## 回路概要

- **入力**: G0, G1, G2, G3 (4個)
- **出力**: G17 (1個)
- **DFF**: G5, G6, G7 (3個)
- **NOT**: G14, G17 (2個)
- **AND**: G8 (1個)
- **NAND**: G9 (1個)
- **OR**: G15, G16 (2個)
- **NOR**: G10, G11, G12, G13 (4個)

## 回路構造

```
入力:
  G0 ──┐
  G1 ──┤
  G2 ──┤
  G3 ──┘

回路:

  G0 ──► [NOT] ──► G14 ──┬──► [NOR] ──► G10 ──► [DFF] ──► G5 ──┐
                          │                                        │
                          └──► [AND] ──► G8 ──┬──► [OR] ──► G15 ──┤
                          │                    │                   │
  G6 ◄── [DFF] ◄── G11 ──┼────────────────────┼───────────────────┤
                          │                    │                   │
                          │                    └──► [OR] ──► G16 ──┤
                          │                                        │
                          │                    ┌──► [NAND] ──► G9 ─┘
                          │                    │
                          └──► [NOR] ──► G11 ──┘
                                         │
                                         └──► [NOT] ──► G17 (出力)

  G1 ──┬──► [NOR] ──► G12 ──┬──► [NOR] ──► G13 ──► [DFF] ──► G7 ──┐
       │                     │                                      │
       │                     └──► [OR] ──► G15                     │
       │                                                           │
       └──────────────────────────────────────────────────────────┘

  G2 ──► [NOR] ──► G13 ──► [DFF] ──► G7 ──► [NOR] ──► G12
```

## 詳細な接続関係

### レベル0: 入力
- G0, G1, G2, G3

### レベル1: 直接入力から生成
- G14 = NOT(G0)

### レベル2: DFF出力に依存（初期化が必要）
- G10 = NOR(G14, G11)  ← G11はDFF出力
- G12 = NOR(G1, G7)    ← G7はDFF出力
- G13 = NOR(G2, G12)

### レベル3: DFFとAND
- G5 = DFF(G10)
- G6 = DFF(G11)
- G7 = DFF(G13)
- G8 = AND(G14, G6)

### レベル4: ORとNAND
- G15 = OR(G12, G8)
- G16 = OR(G3, G8)
- G9 = NAND(G16, G15)
- G11 = NOR(G5, G9)

### レベル5: 出力
- G17 = NOT(G11)

## フィードバックループ

### ループ1: G10 → G5 (DFF) → G11 → G10
```
G10 = NOR(G14, G11)
  ↓
G5 = DFF(G10)
  ↓
G11 = NOR(G5, G9)
  ↑
  └── G10 = NOR(G14, G11)
```
**解決**: DFFでループが切られる

### ループ2: G11 → G6 (DFF) → G8 → G9 → G11
```
G11 = NOR(G5, G9)
  ↓
G6 = DFF(G11)
  ↓
G8 = AND(G14, G6)
  ↓
G9 = NAND(G16, G15)
  ↑
  └── G11 = NOR(G5, G9)
```
**解決**: DFFでループが切られる

### ループ3: G12 → G7 (DFF) → G12
```
G12 = NOR(G1, G7)
  ↓
G7 = DFF(G13)
  ↑
  └── G12 = NOR(G1, G7)
```
**解決**: DFFでループが切られる

### ループ4: G13 → G7 (DFF) → G12 → G13
```
G13 = NOR(G2, G12)
  ↓
G7 = DFF(G13)
  ↓
G12 = NOR(G1, G7)
  ↑
  └── G13 = NOR(G2, G12)
```
**解決**: DFFでループが切られる

## DFFによるループ解決の仕組み

すべてのフィードバックループはDFF（D型フリップフロップ）によって解決されます。

1. **DFFの動作**: クロックエッジで入力値をラッチし、次のサイクルで出力に反映
2. **ループの切断**: DFFは入力に依存せず、クロックに基づいて独立に値を保持
3. **初期化**: DFFの出力は初期状態で定義されるため、ループの初期値が確定

## 信号の依存関係グラフ

```
G0 ──► G14 ──┬──► G10 ──► G5 ──┐
             │                  │
             └──► G8 ◄── G6 ◄── G11 ◄──┐
             │                  │       │
             │                  └───────┘
             │
             └──► G10 ◄── G11 ──┐
                                 │
                                 └──► G9 ◄── G16 ◄── G8
                                             ▲
                                             │
                                    G3 ──────┘

G1 ──► G12 ──┬──► G13 ──► G7 ──┐
             │                 │
             └──► G15          │
                               │
                               └──► G12 ◄──┘

G2 ──► G13 ──► G7 ──► G12 ──► G13 (ループ)

G11 ──► G17 (出力)
```

## 特徴

1. **複数のフィードバックループ**: 4つのループが存在
2. **DFFによる解決**: すべてのループはDFFで解決される
3. **シーケンシャル回路**: DFFを含むため、状態を持つ回路
4. **組み合わせ論理と順序論理の混合**: DFFと組み合わせ論理ゲートが混在

